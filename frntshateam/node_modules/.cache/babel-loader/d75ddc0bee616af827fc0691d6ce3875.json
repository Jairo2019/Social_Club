{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\ShaTeam\\\\frntShateam\\\\src\\\\Vistas\\\\Upload.js\";\nimport React, { useState } from \"react\";\nimport Main from \"../Components/Main\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faUpload } from \"@fortawesome/free-solid-svg-icons\";\nimport Loading from \"../Components/Loading\";\nimport Axios from \"axios\";\nexport default function Upload(_ref) {\n  var history = _ref.history,\n      mostrarError = _ref.mostrarError;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      imagenUrl = _useState2[0],\n      setImagenUrl = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      subiendoImagen = _useState4[0],\n      setSubiendoImagen = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      enviandoPost = _useState6[0],\n      setEnviandoPost = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      caption = _useState8[0],\n      setCaption = _useState8[1];\n\n  function handleImagenSeleccionada(_x) {\n    return _handleImagenSeleccionada.apply(this, arguments);\n  }\n\n  function _handleImagenSeleccionada() {\n    _handleImagenSeleccionada = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var file, config, _yield$Axios$post, data, _error$response;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              setSubiendoImagen(true);\n              file = e.target.files[0];\n              config = {\n                headers: {\n                  \"Content-Type\": file.type\n                }\n              };\n              _context.next = 6;\n              return Axios.post(\"/api/posts/upload\", file, config);\n\n            case 6:\n              _yield$Axios$post = _context.sent;\n              data = _yield$Axios$post.data;\n              setImagenUrl(data.url);\n              setSubiendoImagen(false);\n              _context.next = 17;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](0);\n              setSubiendoImagen(false);\n              mostrarError(_context.t0 === null || _context.t0 === void 0 ? void 0 : (_error$response = _context.t0.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n              console.log(_context.t0);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 12]]);\n    }));\n    return _handleImagenSeleccionada.apply(this, arguments);\n  }\n\n  function handleSubmit(_x2) {\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  function _handleSubmit() {\n    _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(evento) {\n      var body, _error$response2;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              evento.preventDefault();\n\n              if (!enviandoPost) {\n                _context2.next = 5;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 5:\n              if (!subiendoImagen) {\n                _context2.next = 10;\n                break;\n              }\n\n              mostrarError('No sae ha terminado de subir la imagen');\n              return _context2.abrupt(\"return\");\n\n            case 10:\n              if (imagenUrl) {\n                _context2.next = 13;\n                break;\n              }\n\n              mostrarError('Primero selecciona una imagen');\n              return _context2.abrupt(\"return\");\n\n            case 13:\n              _context2.prev = 13;\n              setEnviandoPost(true);\n              body = {\n                caption: caption,\n                url: imagenUrl\n              };\n              _context2.next = 18;\n              return Axios.post('/api/posts', body);\n\n            case 18:\n              setEnviandoPost(false);\n              history.push('/');\n              _context2.next = 25;\n              break;\n\n            case 22:\n              _context2.prev = 22;\n              _context2.t0 = _context2[\"catch\"](13);\n              mostrarError(_context2.t0 === null || _context2.t0 === void 0 ? void 0 : (_error$response2 = _context2.t0.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data);\n\n            case 25:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[13, 22]]);\n    }));\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  return /*#__PURE__*/React.createElement(Main, {\n    center: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Upload\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Upload__image-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(SeccionSubirImagen, {\n    subiendoImagen: subiendoImagen,\n    imagenUrl: imagenUrl,\n    handleImagenSeleccionada: handleImagenSeleccionada,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"textarea\", {\n    name: \"caption\",\n    className: \"Upload__caption\",\n    required: true,\n    maxLength: \"180\",\n    placeholder: \"Caption de tu post.\",\n    value: caption,\n    onChange: function onChange(e) {\n      return setCaption(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"Upload__submit\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, \"Post\"))));\n}\n\nfunction SeccionSubirImagen(_ref2) {\n  var subiendoImagen = _ref2.subiendoImagen,\n      imagenUrl = _ref2.imagenUrl,\n      handleImagenSeleccionada = _ref2.handleImagenSeleccionada;\n\n  if (subiendoImagen) {\n    return /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 16\n      }\n    });\n  } else if (imagenUrl) {\n    return /*#__PURE__*/React.createElement(\"img\", {\n      src: imagenUrl,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 16\n      }\n    });\n  } else {\n    return /*#__PURE__*/React.createElement(\"label\", {\n      className: \"Upload__image-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: faUpload,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    }, \"Publica una foto\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      className: \"hidden\",\n      name: \"imagen\",\n      onChange: handleImagenSeleccionada,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }\n    }));\n  }\n}","map":{"version":3,"sources":["D:/ShaTeam/frntShateam/src/Vistas/Upload.js"],"names":["React","useState","Main","FontAwesomeIcon","faUpload","Loading","Axios","Upload","history","mostrarError","imagenUrl","setImagenUrl","subiendoImagen","setSubiendoImagen","enviandoPost","setEnviandoPost","caption","setCaption","handleImagenSeleccionada","e","file","target","files","config","headers","type","post","data","url","response","console","log","handleSubmit","evento","preventDefault","body","push","value","SeccionSubirImagen"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport Main from \"../Components/Main\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faUpload } from \"@fortawesome/free-solid-svg-icons\";\r\nimport Loading from \"../Components/Loading\";\r\nimport Axios from \"axios\";\r\n\r\nexport default function Upload({ history, mostrarError }) {\r\n    const [imagenUrl, setImagenUrl] = useState(\"\");\r\n    const [subiendoImagen, setSubiendoImagen] = useState(false);\r\n    const [enviandoPost, setEnviandoPost] = useState(false);\r\n    const [caption, setCaption ] = useState('')\r\n\r\n    async function handleImagenSeleccionada(e) {\r\n        try {\r\n        setSubiendoImagen(true);\r\n        const file = e.target.files[0];\r\n        const config = {\r\n            headers: {\r\n            \"Content-Type\": file.type,\r\n            },\r\n        };\r\n        const { data } = await Axios.post(\"/api/posts/upload\", file, config);\r\n        setImagenUrl(data.url);\r\n        setSubiendoImagen(false);\r\n        } catch (error) {\r\n        setSubiendoImagen(false);\r\n        mostrarError(error?.response?.data);\r\n        console.log(error);\r\n        }\r\n    }\r\n\r\n    async function handleSubmit(evento) {\r\n        evento.preventDefault();\r\n\r\n        if(enviandoPost) {\r\n            return;\r\n        } else if(subiendoImagen) {\r\n            mostrarError('No sae ha terminado de subir la imagen');\r\n            return;\r\n        } else if(!imagenUrl) {\r\n            mostrarError('Primero selecciona una imagen');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setEnviandoPost(true);\r\n            const body = {\r\n                caption,\r\n                url: imagenUrl\r\n            };\r\n            await Axios.post('/api/posts', body);\r\n            setEnviandoPost(false);\r\n            history.push('/')\r\n        } catch (error) {\r\n            mostrarError(error?.response?.data);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Main center>\r\n        <div className=\"Upload\">\r\n            <form onSubmit={handleSubmit}>\r\n            <div className=\"Upload__image-section\">\r\n                <SeccionSubirImagen\r\n                subiendoImagen={subiendoImagen}\r\n                imagenUrl={imagenUrl}\r\n                handleImagenSeleccionada={handleImagenSeleccionada}\r\n                />\r\n            </div>\r\n            <textarea\r\n                name=\"caption\"\r\n                className=\"Upload__caption\"\r\n                required\r\n                maxLength=\"180\"\r\n                placeholder=\"Caption de tu post.\"\r\n                value={caption}\r\n                onChange={(e) => setCaption(e.target.value)}\r\n            ></textarea>\r\n            <button className=\"Upload__submit\" type=\"submit\">\r\n                Post\r\n            </button>\r\n            </form>\r\n        </div>\r\n        </Main>\r\n    );\r\n}\r\n\r\nfunction SeccionSubirImagen({\r\n  subiendoImagen,\r\n  imagenUrl,\r\n  handleImagenSeleccionada,\r\n}) {\r\n    if (subiendoImagen) {\r\n        return <Loading />;\r\n    } else if (imagenUrl) {\r\n        return <img src={imagenUrl} />;\r\n    } else {\r\n        return (\r\n        <label className=\"Upload__image-label\">\r\n            <FontAwesomeIcon icon={faUpload} />\r\n            <span>Publica una foto</span>\r\n            <input\r\n            type=\"file\"\r\n            className=\"hidden\"\r\n            name=\"imagen\"\r\n            onChange={handleImagenSeleccionada}\r\n            />\r\n        </label>\r\n        );\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}