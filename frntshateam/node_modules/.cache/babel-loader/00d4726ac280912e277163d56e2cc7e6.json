{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\ShaTeam\\\\frntShateam\\\\src\\\\Components\\\\actions-user\\\\usuario-context.js\";\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { setToken, deleteToken, getToken } from \"../../actions/auth-helpers\";\nimport Axios from \"axios\";\nvar UsuarioContext = React.createContext();\nexport function UsuarioProvider(props) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      usuario = _useState2[0],\n      setUsuario = _useState2[1]; // no sabes si hay un usuario autenticado\n\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      cargandoUsuario = _useState4[0],\n      setCargandoUsuario = _useState4[1];\n\n  useEffect(function () {\n    function cargarUsuario() {\n      return _cargarUsuario.apply(this, arguments);\n    }\n\n    function _cargarUsuario() {\n      _cargarUsuario = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var token, _yield$Axios$get, _usuario;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                token = getToken();\n\n                if (token) {\n                  _context.next = 4;\n                  break;\n                }\n\n                setCargandoUsuario(false);\n                return _context.abrupt(\"return\");\n\n              case 4:\n                _context.prev = 4;\n                _context.next = 7;\n                return Axios.get(\"/api/usuarios/whoami\");\n\n              case 7:\n                _yield$Axios$get = _context.sent;\n                _usuario = _yield$Axios$get.data;\n                setUsuario(_usuario);\n                setCargandoUsuario(false);\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](4);\n                console.log(\"err\", _context.t0);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[4, 13]]);\n      }));\n      return _cargarUsuario.apply(this, arguments);\n    }\n\n    cargarUsuario();\n  }, []);\n\n  function login(_x, _x2) {\n    return _login.apply(this, arguments);\n  }\n\n  function _login() {\n    _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(email, password) {\n      var _yield$Axios$post, data;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return Axios.post(\"/api/usuarios/login\", {\n                email: email,\n                password: password\n              });\n\n            case 2:\n              _yield$Axios$post = _context2.sent;\n              data = _yield$Axios$post.data;\n              //data.usaurio data.token\n              setUsuario(data.usuario);\n              setToken(data.token);\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _login.apply(this, arguments);\n  }\n\n  function signup(_x3) {\n    return _signup.apply(this, arguments);\n  }\n\n  function _signup() {\n    _signup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(usuario) {\n      var _yield$Axios$post2, data;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return Axios.post(\"/api/usuarios/signup\", usuario);\n\n            case 2:\n              _yield$Axios$post2 = _context3.sent;\n              data = _yield$Axios$post2.data;\n              setUsuario(data.usuario);\n              setToken(data.token);\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _signup.apply(this, arguments);\n  }\n\n  function logout() {\n    console.log(\"logout\");\n    setUsuario(null);\n    deleteToken();\n  }\n\n  var value = useMemo(function () {\n    return {\n      usuario: usuario,\n      cargandoUsuario: cargandoUsuario,\n      signup: signup,\n      login: login,\n      logout: logout\n    };\n  }, [usuario, cargandoUsuario]);\n  return /*#__PURE__*/React.createElement(UsuarioContext.Provider, Object.assign({\n    value: value\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 12\n    }\n  }));\n}\nexport function useUsuario() {\n  var context = React.useContext(UsuarioContext);\n\n  if (!context) {\n    throw new Error('useUsuario debe estar dentro del proveedor UsuarioContext');\n  }\n\n  return context;\n}","map":{"version":3,"sources":["D:/ShaTeam/frntShateam/src/Components/actions-user/usuario-context.js"],"names":["React","useState","useEffect","useMemo","setToken","deleteToken","getToken","Axios","UsuarioContext","createContext","UsuarioProvider","props","usuario","setUsuario","cargandoUsuario","setCargandoUsuario","cargarUsuario","token","get","data","console","log","login","email","password","post","signup","logout","value","useUsuario","context","useContext","Error"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo } from \"react\";\r\nimport {\r\n\tsetToken,\r\n\tdeleteToken,\r\n\tgetToken,\r\n} from \"../../actions/auth-helpers\";\r\nimport Axios from \"axios\";\r\n\r\nconst UsuarioContext = React.createContext();\r\n\r\nexport function UsuarioProvider(props) {\r\n\tconst [usuario, setUsuario] = useState(null); // no sabes si hay un usuario autenticado\r\n\tconst [cargandoUsuario, setCargandoUsuario] = useState(true);\r\n\r\n\tuseEffect(() => {\r\n\t\tasync function cargarUsuario() {\r\n\t\t\tlet token = getToken();\r\n\t\t\tif (!token) {\r\n\t\t\t\tsetCargandoUsuario(false);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttry {\r\n\t\t\t\tconst { data: usuario } = await Axios.get(\"/api/usuarios/whoami\");\r\n\t\t\t\tsetUsuario(usuario);\r\n\t\t\t\tsetCargandoUsuario(false);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.log(\"err\", err);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcargarUsuario();\r\n\t}, []);\r\n\r\n\tasync function login(email, password) {\r\n\t\tconst { data } = await Axios.post(\"/api/usuarios/login\", {\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t}); //data.usaurio data.token\r\n\t\tsetUsuario(data.usuario);\r\n\t\tsetToken(data.token);\r\n\t}\r\n\r\n\tasync function signup(usuario) {\r\n\t\tconst { data } = await Axios.post(\"/api/usuarios/signup\", usuario);\r\n\t\tsetUsuario(data.usuario);\r\n\t\tsetToken(data.token);\r\n\t}\r\n\r\n\tfunction logout() {\r\n\t\tconsole.log(\"logout\");\r\n\t\tsetUsuario(null);\r\n\t\tdeleteToken();\r\n    }\r\n    \r\n    const value = useMemo( () => {\r\n        return ({\r\n            usuario,\r\n            cargandoUsuario,\r\n            signup,\r\n            login,\r\n            logout\r\n        })\r\n    }, [usuario, cargandoUsuario]);\r\n\r\n    return <UsuarioContext.Provider value={value} {...props} />\r\n}\r\n\r\nexport function useUsuario() {\r\n    const context = React.useContext(UsuarioContext);\r\n    if(!context) {\r\n        throw new Error('useUsuario debe estar dentro del proveedor UsuarioContext');\r\n    }\r\n    return context;\r\n}\r\n"]},"metadata":{},"sourceType":"module"}