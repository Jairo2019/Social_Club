{"ast":null,"code":"import _objectSpread from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:\\\\ShaTeam\\\\frntShateam\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\ShaTeam\\\\frntShateam\\\\src\\\\Vistas\\\\Perfil.js\";\nimport React, { useState, useEffect } from \"react\";\nimport Main from \"../Components/Main\";\nimport Axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport Loading from \"../Components/Loading\";\nimport Grid from \"../Components/Grid\";\nimport RecursoNoExiste from \"../Components/RecursoNoExiste\";\nimport stringToColor from \"string-to-color\";\nimport toggleSiguiendo from \"../Helpers/amistad-helpers\";\nimport useEsMobil from \"../hooks/useEsMobil\";\nexport default function Perfil(_ref) {\n  var mostrarError = _ref.mostrarError,\n      usuario = _ref.usuario,\n      match = _ref.match,\n      logout = _ref.logout;\n  var username = match.params.username;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      usuarioDuenoDelPerfil = _useState2[0],\n      setUsuarioDuenoDelPerfil = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      posts = _useState4[0],\n      setPosts = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      subiendoImagen = _useState6[0],\n      setSubiendoImagen = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      cargandoPerfil = _useState8[0],\n      setCargandoPerfil = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      perfilNoExiste = _useState10[0],\n      setPerfilNoExiste = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      enviandoAmistad = _useState12[0],\n      setEnviandoAmistad = _useState12[1];\n\n  var esMobil = useEsMobil();\n  useEffect(function () {\n    function cargarPostsYUsuario() {\n      return _cargarPostsYUsuario.apply(this, arguments);\n    }\n\n    function _cargarPostsYUsuario() {\n      _cargarPostsYUsuario = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _yield$Axios$get, _usuario, _yield$Axios$get2, _posts, _error$response, _error$response2;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                setCargandoPerfil(true);\n                _context.next = 4;\n                return Axios.get(\"/api/usuarios/\".concat(username));\n\n              case 4:\n                _yield$Axios$get = _context.sent;\n                _usuario = _yield$Axios$get.data;\n                _context.next = 8;\n                return Axios.get(\"/api/posts/usuario/\".concat(_usuario._id));\n\n              case 8:\n                _yield$Axios$get2 = _context.sent;\n                _posts = _yield$Axios$get2.data;\n                setUsuarioDuenoDelPerfil(_usuario);\n                setPosts(_posts);\n                setCargandoPerfil(false);\n                _context.next = 19;\n                break;\n\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](0);\n\n                if ((_context.t0 === null || _context.t0 === void 0 ? void 0 : (_error$response = _context.t0.response) === null || _error$response === void 0 ? void 0 : _error$response.response) === 404 || (_context.t0 === null || _context.t0 === void 0 ? void 0 : (_error$response2 = _context.t0.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.response) === 400) {\n                  setPerfilNoExiste(true);\n                } else {\n                  mostrarError(\"Hubo un problema cargando este perfil\");\n                }\n\n                setCargandoPerfil(false);\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 15]]);\n      }));\n      return _cargarPostsYUsuario.apply(this, arguments);\n    }\n\n    cargarPostsYUsuario();\n  }, [username]);\n\n  function esElPerfilDeLaPersonaLogin() {\n    return usuario._id === usuarioDuenoDelPerfil._id;\n  }\n\n  function handleImagenSeleccionada(_x) {\n    return _handleImagenSeleccionada.apply(this, arguments);\n  }\n\n  function _handleImagenSeleccionada() {\n    _handleImagenSeleccionada = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event) {\n      var file, config, _yield$Axios$post, data, _error$response$data, _error$response3;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setSubiendoImagen(true);\n              file = event.target.files[0];\n              config = {\n                headers: {\n                  \"Content-Type\": file.type\n                }\n              };\n              _context2.next = 6;\n              return Axios.post(\"/api/usuarios/upload\", file, config);\n\n            case 6:\n              _yield$Axios$post = _context2.sent;\n              data = _yield$Axios$post.data;\n              setUsuarioDuenoDelPerfil(_objectSpread({}, usuarioDuenoDelPerfil, {\n                imagen: data.url\n              }));\n              setSubiendoImagen(false);\n              _context2.next = 17;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](0);\n              mostrarError((_error$response$data = _context2.t0 === null || _context2.t0 === void 0 ? void 0 : (_error$response3 = _context2.t0.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) !== null && _error$response$data !== void 0 ? _error$response$data : \"No se pudo subir la imagne\");\n              setSubiendoImagen(false);\n              console.log(_context2.t0);\n\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 12]]);\n    }));\n    return _handleImagenSeleccionada.apply(this, arguments);\n  }\n\n  function onToggleSiguiendo() {\n    return _onToggleSiguiendo.apply(this, arguments);\n  }\n\n  function _onToggleSiguiendo() {\n    _onToggleSiguiendo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var usuariActualizado;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!enviandoAmistad) {\n                _context3.next = 2;\n                break;\n              }\n\n              return _context3.abrupt(\"return\");\n\n            case 2:\n              _context3.prev = 2;\n              setEnviandoAmistad(true);\n              _context3.next = 6;\n              return toggleSiguiendo(usuarioDuenoDelPerfil);\n\n            case 6:\n              usuariActualizado = _context3.sent;\n              setUsuarioDuenoDelPerfil(usuariActualizado);\n              setEnviandoAmistad(false);\n              _context3.next = 16;\n              break;\n\n            case 11:\n              _context3.prev = 11;\n              _context3.t0 = _context3[\"catch\"](2);\n              mostrarError(\"Hubo un problema siguiendo/dejando de seguir a este usuario, Intenta de nuevo\");\n              setEnviandoAmistad(false);\n              console.log(_context3.t0);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[2, 11]]);\n    }));\n    return _onToggleSiguiendo.apply(this, arguments);\n  }\n\n  if (cargandoPerfil) {\n    return /*#__PURE__*/React.createElement(Main, {\n      center: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 5\n      }\n    }));\n  }\n\n  if (perfilNoExiste) {\n    return /*#__PURE__*/React.createElement(RecursoNoExiste, {\n      mensaje: \"El perfil que estas cargando, no existe\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 4\n      }\n    });\n  }\n\n  if (usuario == null) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(Main, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Perfil\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(ImagenAvatar, {\n    esElPerfilDeLaPersonaLogin: esElPerfilDeLaPersonaLogin,\n    usuarioDuenoDelPerfil: usuarioDuenoDelPerfil,\n    handleImagenSeleccionada: handleImagenSeleccionada,\n    subiendoImagen: subiendoImagen,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Perfil__bio-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Perfil__bio-heading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"capitalize\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }\n  }, usuarioDuenoDelPerfil.username), !esElPerfilDeLaPersonaLogin() && /*#__PURE__*/React.createElement(BotonSeguir, {\n    siguiendo: usuarioDuenoDelPerfil.siguiendo,\n    toggleSiguiendo: onToggleSiguiendo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 8\n    }\n  }), esElPerfilDeLaPersonaLogin() && /*#__PURE__*/React.createElement(BotonLogout, {\n    logout: logout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 40\n    }\n  })), !esMobil && /*#__PURE__*/React.createElement(DescripcionPerfil, {\n    usuarioDuenoDelPerfil: usuarioDuenoDelPerfil,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Perfil__separador\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 21\n    }\n  }), posts.length > 0 ? /*#__PURE__*/React.createElement(Grid, {\n    posts: posts,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 41\n    }\n  }) : /*#__PURE__*/React.createElement(NoHaPosteado, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 67\n    }\n  }))));\n}\n\nfunction DescripcionPerfil(_ref2) {\n  var usuarioDuenoDelPerfil = _ref2.usuarioDuenoDelPerfil;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Perfil__descripcion\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"Perfil__nombre\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 4\n    }\n  }, usuarioDuenoDelPerfil.nombre), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 4\n    }\n  }, usuarioDuenoDelPerfil.bio), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"Perfil__estadisticas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 5\n    }\n  }, usuarioDuenoDelPerfil.numSiguiendo), \" following\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"ml-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 6\n    }\n  }, usuarioDuenoDelPerfil.numSeguidores), \" followers\")));\n}\n\nfunction ImagenAvatar(_ref3) {\n  var esElPerfilDeLaPersonaLogin = _ref3.esElPerfilDeLaPersonaLogin,\n      usuarioDuenoDelPerfil = _ref3.usuarioDuenoDelPerfil,\n      handleImagenSeleccionada = _ref3.handleImagenSeleccionada,\n      subiendoImagen = _ref3.subiendoImagen;\n  var contenido;\n\n  if (subiendoImagen) {\n    contenido = /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 15\n      }\n    });\n  } else if (esElPerfilDeLaPersonaLogin) {\n    contenido = /*#__PURE__*/React.createElement(\"label\", {\n      className: \"Perfil__img-placeholder Perfil__img-placeholder--pointer\",\n      style: {\n        backgroundImage: usuarioDuenoDelPerfil.imagen ? \"url(\".concat(usuarioDuenoDelPerfil.imagen, \")\") : null,\n        backgroundColor: stringToColor(usuarioDuenoDelPerfil.username)\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      className: \"hidden\",\n      onChange: handleImagenSeleccionada,\n      name: \"imagen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 5\n      }\n    }));\n  } else {\n    contenido = /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Perfil__image-placeholder\",\n      style: {\n        backgroundImage: usuarioDuenoDelPerfil.imagen ? \"url(\".concat(usuarioDuenoDelPerfil.imagen, \")\") : null,\n        backgroundColor: stringToColor(usuarioDuenoDelPerfil.username)\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 4\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Perfil__img-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }\n  }, contenido);\n}\n\nfunction BotonSeguir(_ref4) {\n  var siguiendo = _ref4.siguiendo,\n      toggleSiguiendo = _ref4.toggleSiguiendo;\n  return /*#__PURE__*/React.createElement(\"button\", {\n    onClick: toggleSiguiendo,\n    className: \"Perfil__boton-seguir\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 3\n    }\n  }, siguiendo ? \"Dejar de seguir\" : \"Seguir\");\n}\n\nfunction BotonLogout(_ref5) {\n  var logout = _ref5.logout;\n  return /*#__PURE__*/React.createElement(\"button\", {\n    className: \"Perfil__boton-logout\",\n    onClick: logout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 3\n    }\n  }, \"Salir de\");\n}\n\nfunction NoHaPosteado() {\n  return /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 12\n    }\n  }, \"Este usuario no ha posteado fotos\");\n}","map":{"version":3,"sources":["D:/ShaTeam/frntShateam/src/Vistas/Perfil.js"],"names":["React","useState","useEffect","Main","Axios","Link","Loading","Grid","RecursoNoExiste","stringToColor","toggleSiguiendo","useEsMobil","Perfil","mostrarError","usuario","match","logout","username","params","usuarioDuenoDelPerfil","setUsuarioDuenoDelPerfil","posts","setPosts","subiendoImagen","setSubiendoImagen","cargandoPerfil","setCargandoPerfil","perfilNoExiste","setPerfilNoExiste","enviandoAmistad","setEnviandoAmistad","esMobil","cargarPostsYUsuario","get","data","_id","response","esElPerfilDeLaPersonaLogin","handleImagenSeleccionada","event","file","target","files","config","headers","type","post","imagen","url","console","log","onToggleSiguiendo","usuariActualizado","siguiendo","length","DescripcionPerfil","nombre","bio","numSiguiendo","numSeguidores","ImagenAvatar","contenido","backgroundImage","backgroundColor","BotonSeguir","BotonLogout","NoHaPosteado"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Main from \"../Components/Main\";\r\nimport Axios from \"axios\";\r\n\r\nimport { Link } from \"react-router-dom\";\r\nimport Loading from \"../Components/Loading\";\r\nimport Grid from \"../Components/Grid\";\r\nimport RecursoNoExiste from \"../Components/RecursoNoExiste\";\r\nimport stringToColor from \"string-to-color\";\r\nimport toggleSiguiendo from \"../Helpers/amistad-helpers\";\r\nimport useEsMobil from \"../hooks/useEsMobil\";\r\n\r\nexport default function Perfil({ mostrarError, usuario, match, logout }) {\r\n\tconst username = match.params.username;\r\n\tconst [usuarioDuenoDelPerfil, setUsuarioDuenoDelPerfil] = useState(null);\r\n\tconst [posts, setPosts] = useState([]);\r\n\tconst [subiendoImagen, setSubiendoImagen] = useState(false);\r\n\tconst [cargandoPerfil, setCargandoPerfil] = useState(true);\r\n\tconst [perfilNoExiste, setPerfilNoExiste] = useState(false);\r\n\tconst [enviandoAmistad, setEnviandoAmistad] = useState(false);\r\n\tconst esMobil = useEsMobil();\r\n\r\n\tuseEffect(() => {\r\n\t\tasync function cargarPostsYUsuario() {\r\n\t\t\ttry {\r\n\t\t\t\tsetCargandoPerfil(true);\r\n\t\t\t\tconst { data: usuario } = await Axios.get(`/api/usuarios/${username}`);\r\n\t\t\t\tconst { data: posts } = await Axios.get(\r\n\t\t\t\t\t`/api/posts/usuario/${usuario._id}`\r\n\t\t\t\t);\r\n\t\t\t\tsetUsuarioDuenoDelPerfil(usuario);\r\n\t\t\t\tsetPosts(posts);\r\n\t\t\t\tsetCargandoPerfil(false);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tif (\r\n\t\t\t\t\terror?.response?.response === 404 ||\r\n\t\t\t\t\terror?.response?.response === 400\r\n\t\t\t\t) {\r\n\t\t\t\t\tsetPerfilNoExiste(true);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmostrarError(\"Hubo un problema cargando este perfil\");\r\n\t\t\t\t}\r\n\t\t\t\tsetCargandoPerfil(false);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcargarPostsYUsuario();\r\n\t}, [username]);\r\n\r\n\tfunction esElPerfilDeLaPersonaLogin() {\r\n\t\treturn usuario._id === usuarioDuenoDelPerfil._id;\r\n\t}\r\n\r\n\tasync function handleImagenSeleccionada(event) {\r\n\t\ttry {\r\n\t\t\tsetSubiendoImagen(true);\r\n\t\t\tconst file = event.target.files[0];\r\n\t\t\tconst config = {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"Content-Type\": file.type,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t\tconst { data } = await Axios.post(\"/api/usuarios/upload\", file, config);\r\n\t\t\tsetUsuarioDuenoDelPerfil({ ...usuarioDuenoDelPerfil, imagen: data.url });\r\n\t\t\tsetSubiendoImagen(false);\r\n\t\t} catch (error) {\r\n\t\t\tmostrarError(error?.response?.data ?? \"No se pudo subir la imagne\");\r\n\t\t\tsetSubiendoImagen(false);\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tasync function onToggleSiguiendo() {\r\n\t\tif (enviandoAmistad) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsetEnviandoAmistad(true);\r\n\t\t\tconst usuariActualizado = await toggleSiguiendo(usuarioDuenoDelPerfil);\r\n\t\t\tsetUsuarioDuenoDelPerfil(usuariActualizado);\r\n\t\t\tsetEnviandoAmistad(false);\r\n\t\t} catch (error) {\r\n\t\t\tmostrarError(\r\n\t\t\t\t\"Hubo un problema siguiendo/dejando de seguir a este usuario, Intenta de nuevo\"\r\n\t\t\t);\r\n\t\t\tsetEnviandoAmistad(false);\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n\r\n\tif (cargandoPerfil) {\r\n\t\treturn (\r\n\t\t\t<Main center>\r\n\t\t\t\t<Loading />\r\n\t\t\t</Main>\r\n\t\t);\r\n\t}\r\n\r\n\tif (perfilNoExiste) {\r\n\t\treturn (\r\n\t\t\t<RecursoNoExiste mensaje=\"El perfil que estas cargando, no existe\" />\r\n\t\t);\r\n\t}\r\n\r\n\tif (usuario == null) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Main>\r\n\t\t\t<div className=\"Perfil\">\r\n\t\t\t\t<ImagenAvatar\r\n\t\t\t\t\tesElPerfilDeLaPersonaLogin={esElPerfilDeLaPersonaLogin}\r\n\t\t\t\t\tusuarioDuenoDelPerfil={usuarioDuenoDelPerfil}\r\n\t\t\t\t\thandleImagenSeleccionada={handleImagenSeleccionada}\r\n\t\t\t\t\tsubiendoImagen={subiendoImagen}\r\n\t\t\t\t/>\r\n\t\t\t\t<div className=\"Perfil__bio-container\">\r\n\t\t\t\t\t<div className=\"Perfil__bio-heading\">\r\n\t\t\t\t\t\t<h2 className=\"capitalize\">{usuarioDuenoDelPerfil.username}</h2>\r\n\t\t\t\t\t\t{!esElPerfilDeLaPersonaLogin() && (\r\n\t\t\t\t\t\t\t<BotonSeguir\r\n\t\t\t\t\t\t\t\tsiguiendo={usuarioDuenoDelPerfil.siguiendo}\r\n\t\t\t\t\t\t\t\ttoggleSiguiendo={onToggleSiguiendo}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{esElPerfilDeLaPersonaLogin() && <BotonLogout logout={logout} />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{!esMobil && (\r\n\t\t\t\t\t\t<DescripcionPerfil usuarioDuenoDelPerfil={usuarioDuenoDelPerfil} />\r\n\t\t\t\t\t)}\r\n                    <div className=\"Perfil__separador\"></div>\r\n                    {posts.length > 0 ? <Grid posts={posts}  /> : <NoHaPosteado/>}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Main>\r\n\t);\r\n}\r\n\r\nfunction DescripcionPerfil({ usuarioDuenoDelPerfil }) {\r\n\treturn (\r\n\t\t<div className=\"Perfil__descripcion\">\r\n\t\t\t<h2 className=\"Perfil__nombre\">{usuarioDuenoDelPerfil.nombre}</h2>\r\n\t\t\t<p>{usuarioDuenoDelPerfil.bio}</p>\r\n\t\t\t<p className=\"Perfil__estadisticas\">\r\n\t\t\t\t<b>{usuarioDuenoDelPerfil.numSiguiendo}</b> following\r\n\t\t\t\t<span className=\"ml-4\">\r\n\t\t\t\t\t<b>{usuarioDuenoDelPerfil.numSeguidores}</b> followers\r\n\t\t\t\t</span>\r\n\t\t\t</p>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction ImagenAvatar({\r\n\tesElPerfilDeLaPersonaLogin,\r\n\tusuarioDuenoDelPerfil,\r\n\thandleImagenSeleccionada,\r\n\tsubiendoImagen,\r\n}) {\r\n\tlet contenido;\r\n\r\n\tif (subiendoImagen) {\r\n\t\tcontenido = <Loading />;\r\n\t} else if (esElPerfilDeLaPersonaLogin) {\r\n\t\tcontenido = (\r\n\t\t\t<label\r\n\t\t\t\tclassName=\"Perfil__img-placeholder Perfil__img-placeholder--pointer\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tbackgroundImage: usuarioDuenoDelPerfil.imagen\r\n\t\t\t\t\t\t? `url(${usuarioDuenoDelPerfil.imagen})`\r\n\t\t\t\t\t\t: null,\r\n\t\t\t\t\tbackgroundColor: stringToColor(usuarioDuenoDelPerfil.username),\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\tclassName=\"hidden\"\r\n\t\t\t\t\tonChange={handleImagenSeleccionada}\r\n\t\t\t\t\tname=\"imagen\"\r\n\t\t\t\t/>\r\n\t\t\t</label>\r\n\t\t);\r\n\t} else {\r\n\t\tcontenido = (\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"Perfil__image-placeholder\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tbackgroundImage: usuarioDuenoDelPerfil.imagen\r\n\t\t\t\t\t\t? `url(${usuarioDuenoDelPerfil.imagen})`\r\n\t\t\t\t\t\t: null,\r\n\t\t\t\t\tbackgroundColor: stringToColor(usuarioDuenoDelPerfil.username),\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\treturn <div className=\"Perfil__img-container\">{contenido}</div>;\r\n}\r\n\r\nfunction BotonSeguir({ siguiendo, toggleSiguiendo }) {\r\n\treturn (\r\n\t\t<button onClick={toggleSiguiendo} className=\"Perfil__boton-seguir\">\r\n\t\t\t{siguiendo ? \"Dejar de seguir\" : \"Seguir\"}\r\n\t\t</button>\r\n\t);\r\n}\r\n\r\nfunction BotonLogout({ logout }) {\r\n\treturn (\r\n\t\t<button className=\"Perfil__boton-logout\" onClick={logout}>\r\n\t\t\tSalir de \r\n\t\t</button>\r\n\t);\r\n}\r\n\r\nfunction NoHaPosteado() {\r\n    return <p className=\"text-center\">Este usuario no ha posteado fotos</p>\r\n}"]},"metadata":{},"sourceType":"module"}